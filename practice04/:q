# -*- encoding: utf-8 -*-

# 郵便番号一覧を前方一致で検索するプログラム

require 'sqlite3'
require 'rubygems'
require "active_record"

ActiveRecord::Base.establish_connection(
  :adapter  => "sqlite3",
  :database => "zipcodes.db"
)

class User < ActiveRecord::Base
   self.table_name = 'zipcode'
end

puts "検索したい郵便番号を前方一致で入力してください"
num = gets.chop

# 数値の入力処理
unless num =~ /\D/ 
  begin
    puts User.find(:all, :conditions=>["code like ?", num + '%'])
    user = User.find(:all, :conditions=>["code like ?", num + '%'])
    p user.id
  end 
else  
  puts "数値以外は入力しないでください"
end
